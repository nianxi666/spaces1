# 批量激活会员 - 快速指南

## 您的 5 个 Payhip 测试订单

根据您提供的 Payhip 截图，您有以下订单：

| 订单 ID | 邮箱 | 日期 |
|---------|------|------|
| LWRwLk8Pza | sjjshsheueue | Dec 6, 2025 |
| KzyO74ekGX | isisjsjsa@gmail.com | Dec 6, 2025 |
| 2GZxenZ6zp | 3221226810@outlook.com | Dec 6, 2025 |
| yBbje3lvBD | 3425354803@qq.com | Dec 5, 2025 |
| LWRwL28vza | 2198644948@qq.com | Dec 5, 2025 |

## 使用批量激活功能

### 步骤 1：准备数据

在支付设置页面找到"**批量激活会员**"部分，在文本框中输入：

```
用户名1,LWRwLk8Pza,sjjshsheueue
用户名2,KzyO74ekGX,isisjsjsa@gmail.com
用户名3,2GZxenZ6zp,3221226810@outlook.com
用户名4,yBbje3lvBD,3425354803@qq.com
用户名5,LWRwL28vza,2198644948@qq.com
```

**重要**：将 `用户名1`、`用户名2` 等替换为实际的用户名。

### 步骤 2：点击"批量激活"

系统会：
- 逐个处理每一行
- 显示进度（例如："处理中... (3/5)"）
- 显示每个订单的处理结果

### 步骤 3：查看结果

完成后会显示：
```
✓ 成功: 5 / 失败: 0
✓ 用户名1 (LWRwLk8Pza): 成功
✓ 用户名2 (KzyO74ekGX): 成功
...
```

页面会自动刷新，订单会出现在"最近订单"列表中。

## 单个激活（备选方案）

如果您想逐个激活，使用"手动激活会员"部分：

1. 填写：
   - 用户名：例如 `testuser`
   - 订单 ID：例如 `LWRwLk8Pza`
   - 邮箱：例如 `sjjshsheueue`（可选）

2. 点击"激活会员"

3. 完成！

## 如何找到用户名？

有几种方法：

### 方法 1：从支付链接推断

如果用户在支付时使用了包含用户名的链接：
```
https://payhip.com/b/gLQxR?checkout_custom_variables[username]=testuser
```

那么 `testuser` 就是用户名。

### 方法 2：从邮箱查找

在管理后台的用户列表中，通过邮箱查找对应的用户名。

### 方法 3：直接询问用户

如果是测试订单，您应该知道是哪个账号进行的支付。

## 常见问题

### Q: 如果我不知道用户名怎么办？

A: 您需要先确定用户名。可以：
1. 查看您的用户数据库
2. 通过邮箱匹配
3. 询问用户

### Q: 邮箱必须填写吗？

A: 不是必须的，但建议填写，便于记录。

### Q: 可以重复激活同一个订单吗？

A: 不会！系统有防重复保护，同一订单 ID 只会被处理一次。

### Q: 批量激活失败了怎么办？

A: 查看详细的错误信息，通常是：
- 用户名不存在
- 订单 ID 已经被处理过
- 格式不正确

可以修正后重新提交，或者使用单个激活功能。

## 关于 Payhip API 失败

您在测试时看到 Payhip API 返回 403 错误，这是因为：

1. **API Key 可能不正确**：您填写的可能是 Webhook Secret
2. **Payhip API 需要特殊认证**：可能需要不同的 header 或访问方式
3. **Cloudflare 保护**：Payhip 使用 Cloudflare，可能阻止了服务器请求

**但这不影响使用！** 手动激活和批量激活功能不依赖 Payhip API，100% 可靠。

## 推荐工作流程

对于测试和开发：

1. **使用 100% 优惠码**进行测试支付
2. **记录订单 ID 和用户名**
3. **使用批量激活功能**一次性处理
4. **验证会员权限**是否正确开通

对于正式环境：

1. 配置 Payhip Webhook（处理正常付费订单）
2. 保留手动激活功能（处理特殊情况）
3. 定期检查订单列表

## 示例：完整的测试流程

```
# 1. 准备测试账号
testuser1
testuser2
testuser3
testuser4
testuser5

# 2. 使用优惠码支付（在 Payhip 上完成）

# 3. 在批量激活文本框输入：
testuser1,LWRwLk8Pza,sjjshsheueue
testuser2,KzyO74ekGX,isisjsjsa@gmail.com
testuser3,2GZxenZ6zp,3221226810@outlook.com
testuser4,yBbje3lvBD,3425354803@qq.com
testuser5,LWRwL28vza,2198644948@qq.com

# 4. 点击"批量激活"

# 5. 等待完成，查看结果

# 6. 验证：登录各个测试账号，确认会员状态
```

## 订单来源标识

激活后，在"最近订单"列表中，您会看到：

- 🟠 **手动**：通过管理员手动激活创建的订单
- 🔵 **Webhook**：Payhip Webhook 自动创建的订单
- 🟣 **API**：API 查询自动创建的订单

这样可以清楚地了解每个订单的来源。

## 总结

✅ **批量激活功能**让您可以快速处理多个测试订单
✅ **防重复保护**确保安全性
✅ **详细的进度和结果**让您清楚了解处理状态
✅ **100% 可靠**，不依赖 Payhip API 或 Webhook

现在您可以立即处理那 5 个测试订单了！
