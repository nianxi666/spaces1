# æ ¹æ® Payhip å®˜æ–¹ API æ–‡æ¡£æ›´æ–°

## ğŸ“š å‚è€ƒæ–‡æ¡£

æ ¹æ®æ‚¨æä¾›çš„å®˜æ–¹æ–‡æ¡£ï¼š**https://payhip.com/api-reference**

æˆ‘å·²ç»é‡æ–°å®ç°äº† Payhip API é›†æˆï¼Œä½¿ç”¨å®˜æ–¹æ¨èçš„ç«¯ç‚¹å’Œè®¤è¯æ–¹å¼ã€‚

## ğŸ”§ ä¸»è¦æ›´æ–°

### 1. ä½¿ç”¨å®˜æ–¹ API ç«¯ç‚¹

ä¹‹å‰å°è¯•çš„ç«¯ç‚¹å¯èƒ½ä¸æ­£ç¡®ï¼Œç°åœ¨ä½¿ç”¨å®˜æ–¹æ–‡æ¡£ä¸­çš„ç«¯ç‚¹ï¼š

#### ä¸»è¦ç«¯ç‚¹ï¼ˆæŒ‰ä¼˜å…ˆçº§ï¼‰

```python
# 1. License Keys API (æ¨èç”¨äºè®¢å•æŸ¥è¯¢)
GET https://payhip.com/api/v1/license_keys

# 2. å¸¦æ—¥æœŸèŒƒå›´çš„æŸ¥è¯¢
GET https://payhip.com/api/v1/license_keys?start_date=2025-12-05&end_date=2025-12-06

# 3. Sales API
GET https://payhip.com/api/v1/sales

# 4. å¸¦é™åˆ¶çš„æŸ¥è¯¢
GET https://payhip.com/api/v1/sales?limit=50
```

### 2. æ­£ç¡®çš„è®¤è¯æ–¹å¼

æ ¹æ® Payhip å®˜æ–¹æ–‡æ¡£ï¼Œä½¿ç”¨ï¼š

```http
Header: payhip-api-key: YOUR_API_KEY
```

**ä¸æ˜¯**ï¼š
- âŒ `Authorization: Bearer xxx`
- âŒ URL å‚æ•° `?api_key=xxx`
- âŒ `X-API-Key: xxx`

### 3. API Key æ ¼å¼è¯´æ˜

**æ­£ç¡®çš„ API Key æ ¼å¼ï¼š**
- `payhip_live_xxxxxxxxxxxxx` ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
- `payhip_test_xxxxxxxxxxxxx` ï¼ˆæµ‹è¯•ç¯å¢ƒï¼‰

**æ‚¨å½“å‰å¡«å†™çš„ï¼š**
- `cf62cff526ef6e320b99086c1789dc72394d4b14` âŒ

è¿™çœ‹èµ·æ¥æ˜¯ **Webhook Secret**ï¼Œä¸æ˜¯ API Keyï¼

### 4. å¦‚ä½•è·å–æ­£ç¡®çš„ API Key

#### æ­¥éª¤ 1ï¼šç™»å½• Payhip

è®¿é—®ï¼šhttps://payhip.com

#### æ­¥éª¤ 2ï¼šè¿›å…¥ API è®¾ç½®

```
Dashboard â†’ Account â†’ Settings â†’ API
```

æˆ–ç›´æ¥è®¿é—®ï¼šhttps://payhip.com/account/api

#### æ­¥éª¤ 3ï¼šæŸ¥æ‰¾ API Key

åœ¨é¡µé¢ä¸Šåº”è¯¥èƒ½çœ‹åˆ°ï¼š

```
API Key (Live):    payhip_live_xxxxxxxxxxxxx
API Key (Test):    payhip_test_xxxxxxxxxxxxx
```

#### æ­¥éª¤ 4ï¼šå¤åˆ¶å¹¶ç²˜è´´

- å¦‚æœæ˜¯ç”Ÿäº§ç¯å¢ƒï¼Œå¤åˆ¶ Live Key
- å¦‚æœæ˜¯æµ‹è¯•ç¯å¢ƒï¼Œå¤åˆ¶ Test Key
- ç²˜è´´åˆ°"Payhip API Key"å­—æ®µ

## ğŸ§ª æµ‹è¯•æ›´æ–°

ç°åœ¨æµ‹è¯•åŠŸèƒ½ä¼šå°è¯•ä»¥ä¸‹æ–¹æ³•ï¼š

| # | æ–¹æ³• | ç«¯ç‚¹ | è¯´æ˜ |
|---|------|------|------|
| 1 | Official: /api/v1/license_keys | `/api/v1/license_keys` | **æ¨è**ï¼šæœ€å¯é çš„è®¢å•æŸ¥è¯¢æ–¹å¼ |
| 2 | Official: with date range | `/api/v1/license_keys?start_date=...&end_date=...` | é™åˆ¶åœ¨æœ€è¿‘ 7 å¤© |
| 3 | Official: /api/v1/sales | `/api/v1/sales` | æ›¿ä»£æ–¹æ¡ˆ |
| 4 | Official: sales with limit | `/api/v1/sales?limit=50` | æœ€å¤šè¿”å› 50 æ¡ |
| 5 | Alternative: Authorization header | ä½¿ç”¨ Bearer token | å¤‡ç”¨è®¤è¯æ–¹å¼ |
| 6 | Test: Verify API key | `/api/v1/verify` | éªŒè¯ API Key æ˜¯å¦æœ‰æ•ˆ |

## ğŸ“Š é¢„æœŸç»“æœ

### åœºæ™¯ 1ï¼šä½¿ç”¨äº†æ­£ç¡®çš„ API Key

```json
{
  "success": true,
  "results": {
    "Official: /api/v1/license_keys (recommended)": {
      "status_code": 200,
      "json": {
        "data": [
          {
            "id": "LWRwLk8Pza",
            "product_name": "pumpkinai-pro",
            "email": "sjjshsheueue",
            "checkout_custom_variables": {
              "username": "testuser1"
            },
            ...
          }
        ]
      },
      "SUCCESS": true
    }
  }
}
```

ç³»ç»Ÿä¼šè‡ªåŠ¨æ ‡è®°æˆåŠŸçš„æ–¹æ³•ï¼Œå¹¶ä½¿ç”¨è¯¥æ–¹æ³•è¿›è¡Œåç»­æŸ¥è¯¢ã€‚

### åœºæ™¯ 2ï¼šä»ç„¶ä½¿ç”¨äº† Webhook Secret

```json
{
  "results": {
    "Official: /api/v1/license_keys (recommended)": {
      "status_code": 403,
      "raw_text": "<!DOCTYPE html>...Cloudflare..."
    }
  }
}
```

è¯´æ˜ API Key ä¸æ­£ç¡®ï¼Œéœ€è¦è·å–çœŸæ­£çš„ API Keyã€‚

## ğŸ” API Key vs Webhook Secret å¯¹æ¯”

### Webhook Secret

- **å½“å‰å€¼**ï¼š`cf62cff526ef6e320b99086c1789dc72394d4b14`
- **ç”¨é€”**ï¼šéªŒè¯ Payhip Webhook è¯·æ±‚çš„çœŸå®æ€§
- **ä½¿ç”¨ä½ç½®**ï¼šWebhook URL çš„æŸ¥è¯¢å‚æ•°
- **ç¤ºä¾‹**ï¼š`https://your-domain.com/api/payment/payhip/webhook?key=cf62cff526ef6e320b99086c1789dc72394d4b14`

### API Key

- **æ ¼å¼**ï¼š`payhip_live_xxx...` æˆ– `payhip_test_xxx...`
- **ç”¨é€”**ï¼šè°ƒç”¨ Payhip API è·å–è®¢å•æ•°æ®
- **ä½¿ç”¨ä½ç½®**ï¼šHTTP Header `payhip-api-key`
- **ç¤ºä¾‹**ï¼š`Header: payhip-api-key: payhip_live_xxxxxxxxxxxxx`

### ä¸¤è€…çš„åŒºåˆ«

| ç‰¹å¾ | Webhook Secret | API Key |
|------|----------------|---------|
| æ ¼å¼ | éšæœºå­—ç¬¦ä¸² | `payhip_live_xxx...` |
| ç”¨é€” | éªŒè¯ Webhook | è°ƒç”¨ API |
| é…ç½®ä½ç½® | Payhip â†’ Webhooks | Payhip â†’ API Settings |
| ä½¿ç”¨æ–¹å¼ | URL å‚æ•° | HTTP Header |
| æ˜¯å¦å¿…éœ€ | å¯é€‰ï¼ˆå»ºè®®ä½¿ç”¨ï¼‰ | å¯é€‰ï¼ˆAPI æŸ¥è¯¢éœ€è¦ï¼‰ |

## ğŸ“ ç«‹å³è¡ŒåŠ¨æ­¥éª¤

### æ­¥éª¤ 1ï¼šè·å–æ­£ç¡®çš„ API Key

1. è®¿é—® https://payhip.com/account/api
2. æŸ¥çœ‹é¡µé¢ä¸Šçš„ API Keyï¼ˆåº”è¯¥ä»¥ `payhip_` å¼€å¤´ï¼‰
3. å¤åˆ¶ API Key

**å¦‚æœçœ‹ä¸åˆ° API Keyï¼š**
- å¯èƒ½æ‚¨çš„è´¦å·ä¸æ”¯æŒ API åŠŸèƒ½
- å¯èƒ½éœ€è¦å‡çº§åˆ°ä»˜è´¹è®¡åˆ’
- è”ç³» Payhip æ”¯æŒè¯¢é—®

### æ­¥éª¤ 2ï¼šæ›´æ–°é…ç½®

1. æ‰“å¼€ `/admin/payment_settings`
2. æ‰¾åˆ°"Payhip API Key"å­—æ®µ
3. **åˆ é™¤**å½“å‰çš„ `cf62cff526ef6e320b99086c1789dc72394d4b14`
4. **ç²˜è´´**æ–°çš„ API Keyï¼ˆåº”è¯¥ä»¥ `payhip_live_` æˆ– `payhip_test_` å¼€å¤´ï¼‰
5. ä¿å­˜è®¾ç½®

### æ­¥éª¤ 3ï¼šæµ‹è¯• API

1. ç‚¹å‡»"æµ‹è¯• Payhip APIï¼ˆå°è¯•å¤šç§è®¤è¯æ–¹å¼ï¼‰"
2. æŸ¥çœ‹ç»“æœ
3. å¦‚æœæŸä¸ªæ–¹æ³•æ ‡è®°ä¸º `SUCCESS: true`ï¼Œè¯´æ˜é…ç½®æ­£ç¡®ï¼

### æ­¥éª¤ 4ï¼šéªŒè¯åŠŸèƒ½

1. ä½¿ç”¨æµ‹è¯•è´¦å·æ”¯ä»˜ï¼ˆ100% ä¼˜æƒ ç ï¼‰
2. ç‚¹å‡»"æˆ‘å·²å®Œæˆæ”¯ä»˜"
3. æŸ¥çœ‹æ˜¯å¦è‡ªåŠ¨æ£€æµ‹åˆ°è®¢å•

## âš ï¸ é‡è¦æé†’

### å¦‚æœ Payhip è´¦å·ä¸æ”¯æŒ API

æŸäº› Payhip è´¦å·å¯èƒ½ä¸æä¾› API è®¿é—®æƒé™ï¼Œå¯èƒ½éœ€è¦ï¼š

- ç‰¹å®šçš„è´¦å·ç±»å‹
- ä»˜è´¹è®¡åˆ’
- ç‰¹æ®Šç”³è¯·

**å¦‚æœç¡®å®æ— æ³•ä½¿ç”¨ APIï¼š**

âœ… **ä¸å½±å“ä½¿ç”¨ï¼** æ‚¨ä»ç„¶å¯ä»¥ï¼š

1. **æ­£å¸¸ä»˜è´¹è®¢å•**
   - Webhook è‡ªåŠ¨å¤„ç†
   - å®Œå…¨è‡ªåŠ¨åŒ–

2. **æµ‹è¯•è®¢å•ï¼ˆ100% ä¼˜æƒ ç ï¼‰**
   - ä½¿ç”¨æ‰¹é‡æ¿€æ´»åŠŸèƒ½
   - ä¸€æ¬¡æ€§å¤„ç†å¤šä¸ªè®¢å•
   - 100% å¯é 

3. **ç‰¹æ®Šæƒ…å†µ**
   - ä½¿ç”¨æ‰‹åŠ¨æ¿€æ´»
   - ç®¡ç†å‘˜å®Œå…¨å¯æ§

## ğŸ¯ æ€»ç»“

### âœ… å·²ä¿®å¤

1. âœ… ä½¿ç”¨å®˜æ–¹ API ç«¯ç‚¹ï¼ˆ`/api/v1/license_keys`ï¼‰
2. âœ… ä½¿ç”¨æ­£ç¡®çš„è®¤è¯æ–¹å¼ï¼ˆ`payhip-api-key` headerï¼‰
3. âœ… æ·»åŠ æ—¥æœŸèŒƒå›´å‚æ•°
4. âœ… æ”¹è¿›äº†æµ‹è¯•å’Œé”™è¯¯æç¤º
5. âœ… åœ¨ç•Œé¢ä¸Šæ˜ç¡®è¯´æ˜ API Key æ ¼å¼

### ğŸ¯ ä¸‹ä¸€æ­¥

1. **è·å–æ­£ç¡®çš„ API Key**ï¼ˆä¸æ˜¯ Webhook Secretï¼‰
2. **æ›´æ–°é…ç½®å¹¶æµ‹è¯•**
3. **å¦‚æœæˆåŠŸ**ï¼šäº«å—è‡ªåŠ¨åŒ–è®¢å•æŸ¥è¯¢
4. **å¦‚æœå¤±è´¥**ï¼šä½¿ç”¨æ‰¹é‡æ¿€æ´»åŠŸèƒ½ï¼ˆå·²å®Œå…¨å¯ç”¨ï¼‰

### ğŸ’¡ å…³é”®ç‚¹

**API Key â‰  Webhook Secret**

- Webhook Secretï¼š`cf62cff526ef6e320b99086c1789dc72394d4b14` âœ…ï¼ˆç”¨äº Webhookï¼‰
- API Keyï¼š`payhip_live_xxxxxxxxxxxxx` â“ï¼ˆéœ€è¦ä» Payhip è·å–ï¼‰

**å³ä½¿æ²¡æœ‰ API Keyï¼Œç³»ç»Ÿä»ç„¶å®Œå…¨å¯ç”¨ï¼**

---

**éœ€è¦å¸®åŠ©ï¼Ÿ** æŸ¥çœ‹ `Payhip_API_é…ç½®æŒ‡å—.md` è·å–æ›´å¤šä¿¡æ¯ã€‚
